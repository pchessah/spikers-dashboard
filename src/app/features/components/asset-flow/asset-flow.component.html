<div class="w-full flex flex-col items-center gap-[10px]">
  <h2 class="text-[var(--color-spikers-green)] font-bold text-spikers-xl text-start w-full">Lorem Lorem Lorem</h2>

  <div class="bg-[var(--color-spikers-grey-50)] rounded-[var(--radius-spikers-lg)] w-full  py-2.5 px-4 gap-2.5 min-h-[307px] ">

    <div class="w-full flex flex-col items-center justify-center relative h-[229px] overflow-x-auto">

          <!-- Main flow nodes -->
          <div class="flex flex-row items-center gap-0 w-full justify-center">
            <!-- Node 1: Source -->
            <div class="px-[6.75px]">
              <div class="flex flex-col items-center "
                   (mouseenter)="onNodeMouseEnter($event)"
                   (mouseleave)="onNodeMouseLeave()">
                <div class="relative flex items-center justify-center w-[53px] h-[53px] rounded-full bg-[var(--color-spikers-contextual-risk-bg)]">
                  <img ngSrc="/icons/venetian-mask.svg" width="26" height="26" alt="Venetian Mask" />
                  <img ngSrc="/icons/user-alt.svg" width="20" height="20" alt="Superscript User" class="absolute -top-1 -right-1" />
                </div>
                <span class="text-xs text-[var(--color-spikers-soft-grey)] mt-1 font-semibold">Loremipsumm</span>
                <div *ngIf="showVulnPopover"
                     class="fixed z-50 transition-opacity duration-200 bg-white rounded-[var(--radius-spikers-xxl,2rem)] shadow-spikers-lg"
                     [ngStyle]="{ left: popoverX + 'px', top: popoverY + 'px' }"
                     (mouseenter)="showVulnPopover = true"
                     (mouseleave)="onNodeMouseLeave()">
                  <app-vulnerabilities-drawer></app-vulnerabilities-drawer>
                </div>
              </div>
            </div>
            <!-- Arrow -->
            <img ngSrc="/icons/arrow2.svg" width="58.5" height="24" alt="Arrow 2"  />
            <!-- Node 2: Processing -->
            <div class="px-[6.75px]">
              <div class="flex flex-col items-center">
                <div class="flex items-center justify-center w-[53px] h-[53px] rounded-full bg-[var(--color-spikers-blue-bg)]">
                  <img ngSrc="/icons/server.svg" width="26" height="26" alt="Server" />
                </div>
                <span class="text-xs text-[var(--color-spikers-soft-grey)] mt-1 font-semibold">Loremipsu</span>
              </div>
            </div>
            <!-- Arrow -->
            <img ngSrc="/icons/arrow2.svg" width="58.5" height="24" alt="Arrow 2"  />
            <!-- Node 3: Destination -->
            <div class="px-[6.75px]">
              <div class="flex flex-col items-center">
                <div class="flex items-center justify-center w-[53px] h-[53px] rounded-full bg-[var(--color-spikers-blue-bg)]">
                  <img ngSrc="/icons/server.svg" width="26" height="26" alt="Server" />
                </div>
                <span class="text-xs text-[var(--color-spikers-soft-grey)] mt-1 font-semibold">Loremipsu</span>
              </div>
            </div>

            <div class="flex flex-col items-center justify-center">
              <img ngSrc="/icons/arrow3.svg" width="105" height="24" alt="Arrow 3" />

            </div>


            <div class="px-[6.75px] mt-3">
              <div class="flex flex-col items-center justify-center min-w-[120px] gap-5">
                <!-- User A (top) -->
                <div class="flex flex-col items-center mb-0">
                  <div class="relative flex items-center justify-center w-[53px] h-[53px] rounded-full bg-[var(--color-spikers-blue-bg)]">
                    <img ngSrc="/icons/server.svg" width="26" height="26" alt="Server" />
                    <div class="absolute -top-1 -right-1 w-5 h-5 rounded-full bg-[var(--color-spikers-red)] flex items-center justify-center">
                      <img ngSrc="/icons/shield-critical.svg" width="10" height="13" alt="Critical Shield" />
                    </div>
                  </div>
                  <span class="text-xs text-[var(--color-spikers-soft-grey)] mt-1 font-semibold">Loremipsumdolorsit</span>
                  <span class="text-[10px] text-[var(--color-spikers-soft-grey)]">192.168.1.13</span>
                </div>
                <!-- User B (bottom) -->
                <div class="flex flex-col items-center mt-0">
                  <div class="relative flex items-center justify-center w-[53px] h-[53px] rounded-full bg-[var(--color-spikers-blue-bg)]">
                    <img ngSrc="/icons/server.svg" width="26" height="26" alt="Server" />
                    <div class="absolute -top-1 -right-1 w-5 h-5 rounded-full bg-[var(--color-spikers-red)] flex items-center justify-center">
                      <img ngSrc="/icons/shield-critical.svg" width="10" height="13" alt="Critical Shield" />
                    </div>
                  </div>
                  <span class="text-xs text-[var(--color-spikers-soft-grey)] mt-1 font-semibold">Loremipsumdolorsit002</span>
                  <span class="text-[10px] text-[var(--color-spikers-soft-grey)]">192.168.1.14</span>
                </div>
              </div>
            </div>
          </div>


    </div>

    <hr class="border-t border-gray-200 my-2 w-full" />

    <div class="flex flex-col sm:flex-row gap-6 items-start mt-4">
      @for (shield of shields; track shield.label) {
      <div class="flex items-center gap-2">
        <div class="flex items-center justify-center w-[25px] h-[25px] rounded-full" [ngClass]="shield.bgColor">
          <img ngSrc="/icons/shield-critical.svg" width="17.5" height="17.5" alt="Critical Shield" />
        </div>
        <span class="text-spikers-sm2 font-semibold" [ngClass]="shield.textColor">{{ shield.label }}</span>
      </div>
      }
    </div>
  </div>
</div>
